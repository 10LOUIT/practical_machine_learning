{
    "contents" : "library(lattice)\nlibrary(ggplot2)\nlibrary(caret)\ndata(faithful)\nset.seed(333)\ninTrain <- createDataPartition(y=faithful$waiting, p = 0.5, list = FALSE)\ntrainFaith <- faithful[inTrain,]\ntestFaith <- faithful[-inTrain,]\nhead(trainFaith)\nplot(trainFaith$waiting, trainFaith$eruptions, pch=19, col=\"blue\", xlab = \"waiting\", ylab = \"Duration\")\nlm1 <- lm(eruptions ~ waiting, data=trainFaith)\nsummary(lm1)\nlines(trainFaith$waiting, lm1$fitted, lwd=3)\ncoef(lm1)[1] + coef(lm1)[2]*80\nprediction <- coef(lm1)[1] + coef(lm1)[2]*80\nprint(prediction)\nnewdata <- data.frame(waiting=80)\npredict(lm1,newdata)\npar(mfrow=c(1,2))\nplot(trainFaith$waiting, trainFaith$eruptions, pch=19, col=\"blue\", xlab = \"waiting\", ylab = \"Duration\")\nlm1 <- lm(eruptions ~ waiting, data=trainFaith)\nlines(trainFaith$waiting, lm1$fitted, lwd=3)\nplot(testFaith$waiting, testFaith$eruptions, pch=19, col=\"blue\", xlab = \"waiting\", ylab = \"Duration\")\nlines(testFaith$waiting, predict(lm1, newdata=testFaith), lwd=3)\n# Calculate RMSE on training\nsqrt(sum((lm1$fitted-trainFaith$eruptions)^2))\n# Calculate RMSE on test\nsqrt(sum((predict(lm1, newdata = testFaith)-testFaith$eruptions)^2))\n# Prediction intervals\npred1 <- predict(lm1, newdata = testFaith, interval = \"prediction\")\nord <- order(testFaith$waiting)\npar(mfrow=c(1,1))\nplot(testFaith$waiting,testFaith$eruptions,pch=19, col=\"blue\")\nmatlines(testFaith$waiting[ord], pred1[ord,], type = \"l\", col = c(1,2,2), lty=c(1,1,1), lwd=3)\nhead(testFaith)\nhead(testFaith$waiting[ord])\nhead(pred1)\nhead(pred1[ord,])\nmodFit <- train(eruptions~waiting, data=trainFaith,method=\"lm\")\nsummary(modFit$finalModel)\n",
    "created" : 1448102495590.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1195445083",
    "id" : "F4F0D3FA",
    "lastKnownWriteTime" : 1448106234,
    "path" : "~/Documents/github/practical_machine_learning/predicting_regression.R",
    "project_path" : "predicting_regression.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}